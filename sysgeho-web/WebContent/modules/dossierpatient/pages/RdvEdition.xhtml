<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
      
 	<ui:composition template="/shared/templates/templateFormulaireEdition.xhtml">
   			
		<ui:param name="managedBean" value="#{sessionScope[rdvCtrl.nomManagedBean2]}" />
		<ui:param name="entetePage" value=" d'un Rendez vous" />
		
	<!-- Definition du contenu de l'ecran principal  -->
		<ui:define name="ecranPrincipalContenu">
		
			<h:panelGroup>
				<fieldset>
					<legend> <h:outputText value="Type de rendez-vous" styleClass="legend" />  </legend>

        			<h:panelGrid columns="2" width="100%" columnClasses="pngdColMiddle" rowClasses="pngdRow"  >
        							         		
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >
         				
							<h:outputText value="Type de rendez-vous" />
							<h:panelGroup >	
								<h:selectOneMenu id="cod_typrdv" value="#{rdvCtrl.defaultVue.entiteCourante.codTypRdv}" style="width: 40%"  title="Type de rendez-vous" required="true">
									<f:selectItem itemLabel="" itemValue="#{null}"/>
									<f:selectItems  value="#{rdvCtrl.defaultVue.listeTypRdv}"/> 
									<a4j:support event="onchange" ajaxSingle="true" actionListener="#{defaultVue.updateLibTypRdv}" reRender="pngp_libTypRdv" />						
								</h:selectOneMenu>	
								<rich:message for="cod_typrdv" errorClass="msg_error" />
							</h:panelGroup> 
							
							<h:outputText value=""	 />
							<h:panelGroup id="pngp_libTypRdv">
								<h:panelGroup>
									<h:inputText value="#{rdvCtrl.defaultVue.entiteCourante.libTypRdv}" style="width: 60%" readonly="true"  rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.libTypRdv}" />
								</h:panelGroup>								
							</h:panelGroup>
							
         				</h:panelGrid>  
         				
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >
							
         				</h:panelGrid> 
         				         		         		
         			</h:panelGrid>  
         	
				</fieldset>								
			</h:panelGroup>
			
			<h:panelGroup>
				<fieldset>
					<legend> <h:outputText value="Service d'admission" styleClass="legend" />  </legend>

        			<h:panelGrid columns="2" width="100%" columnClasses="pngdColMiddle" rowClasses="pngdRow"  >
        							         		
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >
         				
							<h:outputText value="Service d'admission" />
							<h:panelGroup >	
								<h:selectOneMenu id="cod_Serc" value="#{rdvCtrl.defaultVue.entiteCourante.codSvc}" style="width: 40%"  title="Service d'admission" required="true">
									<f:selectItem itemLabel="" itemValue="#{null}"/>
									<f:selectItems  value="#{rdvCtrl.defaultVue.listeSvc}"/> 
									<a4j:support event="onchange" ajaxSingle="true" actionListener="#{defaultVue.updateLibSvc}" reRender="pngp_libSvc" />						
								</h:selectOneMenu>	
								<rich:message for="cod_Serc" errorClass="msg_error" />
							</h:panelGroup> 
							
							<h:outputText value=""	 />
							<h:panelGroup id="pngp_libSvc">
								<h:panelGroup>
									<h:inputText value="#{rdvCtrl.defaultVue.entiteCourante.libSvc}" style="width: 60%" readonly="true"  rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.libSvc}" />
								</h:panelGroup>								
							</h:panelGroup>
							
         				</h:panelGrid>  
         				
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >
							
         				</h:panelGrid> 
         				         		         		
         			</h:panelGrid>  
         	
				</fieldset>								
			</h:panelGroup>
			
			<h:panelGroup>
				<fieldset>
					<legend> <h:outputText value="Informations Patient" styleClass="legend" />  </legend>

        			<h:panelGrid columns="2" width="100%" columnClasses="pngdColMiddle" rowClasses="pngdRow"  >
        							         		
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >

							
							<h:outputText value="Patient" />
							<h:panelGroup>
							<h:inputText id="inpt_codPat" value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}" style="width: 20%" 
								required="true"
								readonly="true" 
								title="Code" disabled="false">
								<a4j:support event="onchange" ajaxSingle="true" 
									reRender="prenom_1,prenom_2,mat_1,mat_2,datnais_1,datnais_2,sexe_1,sexe_2,aff_1,aff_2,soc_1,soc_2,prof_1,prof_2,med_1,med_2,enreg_1,enreg_2"/>
							</h:inputText>	
							<h:inputText id="inpt_libPat" value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.libNom}" style="width: 40%" 
									required="false"
									readonly="true"  
									title="#{locale.libelle}" disabled="false"> 
									<a4j:support event="onchange" ajaxSingle="true" />
							</h:inputText>
							<!--  Selection d'une Entite avec envoi des parametres correspondants  -->
							<h:panelGroup>
								<a4j:commandButton   value="..." action="#{rdvCtrl.makeSelection}" ajaxSingle="true" immediate="true" disabled="false" >   	
		           						<!-- Regle de Navigation permettant de revenir a la page source   -->           					          							
		         						<f:setPropertyActionListener value="RdvEdition" target="#{patCtrl.defaultVue.navigationMgr.selectionSource}" />
		         						<!-- MAJ de la destination en mode Selection   --> 
		           						<f:setPropertyActionListener value="true" target="#{patCtrl.defaultVue.navigationMgr.enSelection}" />  
		           						<!-- Nom du Controlleur de l'entite source  --> 
		          						<f:setPropertyActionListener value="rdvCtrl" target="#{patCtrl.defaultVue.navigationMgr.selectionBeanCtrlName}" /> 
		          						<!-- Regle de Navigation permettant d'atteindre le formulaire de destination  -->   
		          						<f:setPropertyActionListener value="PatListe" target="#{defaultVue.navigationMgr.selectionDestination}" />	
		          						<!-- Nom de la propriete a selectionner -->							         						             						
		          						<f:setPropertyActionListener value="tabPat" target="#{defaultVue.navigationMgr.selectionPropertyName}" />            						             						          						             				            					      						
				             	</a4j:commandButton>
				             	<rich:message for="inpt_codPat" errorClass="msg_error" />
							</h:panelGroup>
						</h:panelGroup>
							
							<h:panelGroup id="prenom_1">
								<h:outputText value="#{locale.prenom}" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}" />
							</h:panelGroup>
							<h:panelGroup id="prenom_2">							
								<h:inputText  value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.libPre}" style="width: 40%" readonly="true"  title="#{locale.prenom}" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>
							
							<h:panelGroup id="mat_1">
								<h:outputText value="Matricule" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>	
							</h:panelGroup>		
							<h:panelGroup id="mat_2">								
								<h:inputText  value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.libMat}" style="width: 40%" readonly="true"  title="Matricule" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>
							
							<h:panelGroup id="datnais_1">
								<h:outputText value="Date de naissance" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>	
							<h:panelGroup id="datnais_2">
								<h:inputText value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.dateNais}" readonly="true" style="width: 30%" title="Date de naissance" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}" >
									<f:convertDateTime type="date" dateStyle="full" pattern="dd/MM/yyyy" timeZone="GMT+1" />
								</h:inputText>
							</h:panelGroup>
							
							<h:panelGroup id="sexe_1">
								<h:outputText value="Sexe"  rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>	
							<h:panelGroup id="sexe_2">
								<h:selectOneRadio  value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.libSex}" disabled="true" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}">
									<f:selectItem itemLabel="M" itemValue="M"  />
									<f:selectItem itemLabel="F" itemValue="F"/>
								</h:selectOneRadio>
							</h:panelGroup>	
							
						</h:panelGrid>
							
						<h:panelGrid columns="2" width="100%" columnClasses="pngdColLeftDynamic,pngdLColRightDynamic" cellspacing="10" >
							
							<h:panelGroup id="aff_1">
								<h:outputText value="#{locale.estaffilie} ?" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>
							<h:panelGroup id="aff_2">
								<h:selectBooleanCheckbox value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.BEstAff}"  disabled="true" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}">
									<a4j:support ajaxSingle="true"  event="onchange" />
								</h:selectBooleanCheckbox>
							</h:panelGroup>
							
							<h:panelGroup id="soc_1">
								<h:outputText value="#{locale.societe}" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>
							<h:panelGroup id="soc_2">
								<h:inputText id="inpt_codSoc" value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.codSoc}" style="width: 20%" 
									readonly="true" title="Code" disabled="false" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}">
									<a4j:support event="onchange" ajaxSingle="true" />
								</h:inputText>	
								<h:inputText id="inpt_libSoc" value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.libSoc}" style="width: 40%" 
										readonly="true"  title="#{locale.libelle}" disabled="false" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"> 
										<a4j:support event="onchange" ajaxSingle="true" />
								</h:inputText>
							</h:panelGroup>
							
							<h:panelGroup id="prof_1">
								<h:outputText value="Profession" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>
							<h:panelGroup id="prof_2">
								<h:inputText id="inpt_prof"  value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.libProf}" style="width: 60%" readonly="true" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}">							 	
									<a4j:support event="onchange"  ajaxSingle="true" />											
								</h:inputText>
							</h:panelGroup>
							
							<h:panelGroup id="med_1">
								<h:outputText value="#{locale.medecintraitant}" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>
							<h:panelGroup id="med_2">
								<h:inputText  value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.libMed}" style="width: 60%" readonly="true" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}">							 	
									<a4j:support event="onchange"  ajaxSingle="true" />											
								</h:inputText>
							</h:panelGroup>
							
							<h:panelGroup id="enreg_1">
								<h:outputText value="Date enregistrement" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}"/>
							</h:panelGroup>
							<h:panelGroup id="enreg_2">
								<h:inputText value="#{rdvCtrl.defaultVue.entiteCourante.tabPat.dateEnreg}" readonly="true" style="width: 30%" title="Date enregistrement"  rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabPat.codPat}">
									<f:convertDateTime type="date" dateStyle="full" pattern="dd/MM/yyyy" timeZone="GMT+1" />
								</h:inputText>
							</h:panelGroup>
							
						</h:panelGrid>
					</h:panelGrid>
         	
				</fieldset>								
			</h:panelGroup>

			<h:panelGroup>
				<fieldset>
					<legend> <h:outputText value="#{locale.medecin}" styleClass="legend" />  </legend>

        			<h:panelGrid columns="2" width="100%" columnClasses="pngdColMiddle" rowClasses="pngdRow"  >
        							         		
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >

							<h:outputText value="#{locale.medecin}" />
							<h:panelGroup>
							<h:inputText id="inpt_codMed" value="#{rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}" style="width: 20%" 
								required="true"
								readonly="true" 
								title="Code" disabled="false">
								<a4j:support event="onchange" ajaxSingle="true" reRender="prenomusr_1,prenomusr_2,ser_1,ser_2,rol_1,rol_2,adr1_1,adr_2"/>
							</h:inputText>	
							<h:inputText id="inpt_libMed" value="#{rdvCtrl.defaultVue.entiteCourante.tabUsr.libNom}" style="width: 40%" 
									required="false"
									readonly="true"  
									title="#{locale.libelle}" disabled="false"> 
									<a4j:support event="onchange" ajaxSingle="true" />
							</h:inputText>
							<!--  Selection d'une Entite avec envoi des parametres correspondants  -->
							<h:panelGroup>
								<a4j:commandButton   value="..." action="#{rdvCtrl.makeSelection}" ajaxSingle="true" immediate="true" disabled="false" >   	
		           						<!-- Regle de Navigation permettant de revenir a la page source   -->           					          							
		         						<f:setPropertyActionListener value="RdvEdition" target="#{usrCtrl.defaultVue.navigationMgr.selectionSource}" />
		         						<!-- MAJ de la destination en mode Selection   --> 
		           						<f:setPropertyActionListener value="true" target="#{usrCtrl.defaultVue.navigationMgr.enSelection}" />  
		           						<!-- Nom du Controlleur de l'entite source  --> 
		          						<f:setPropertyActionListener value="rdvCtrl" target="#{usrCtrl.defaultVue.navigationMgr.selectionBeanCtrlName}" /> 
		          						<!-- Regle de Navigation permettant d'atteindre le formulaire de destination  -->   
		          						<f:setPropertyActionListener value="UsrListe" target="#{defaultVue.navigationMgr.selectionDestination}" />	
		          						<!-- Nom de la propriete a selectionner -->							         						             						
		          						<f:setPropertyActionListener value="tabUsr" target="#{defaultVue.navigationMgr.selectionPropertyName}" />            						             						          						             				            					      						
				             	</a4j:commandButton>
				             	<rich:message for="inpt_codMed" errorClass="msg_error" />
							</h:panelGroup>
						</h:panelGroup>
						
						<h:panelGroup id="prenomusr_1">
							<h:outputText value="#{locale.prenom}" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>	
						</h:panelGroup>
						<h:panelGroup id="prenomusr_2">
							<h:inputText  value="#{rdvCtrl.defaultVue.entiteCourante.tabUsr.libPre}" style="width: 40%" readonly="true"  title="#{locale.prenom}" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>
						</h:panelGroup>
								
						<h:panelGroup id="ser_1">
							<h:outputText value="Services" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>
						</h:panelGroup>								
						<h:panelGroup id="ser_2">
							<h:inputText  value="#{rdvCtrl.defaultVue.entiteCourante.tabUsr.libSvc}" style="width: 60%"  readonly="true" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>	
						</h:panelGroup>	
							
         			</h:panelGrid>  
         				
         			<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >
         				
         				<h:panelGroup id="rol_1">
							<h:outputText value="#{locale.role}" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>
						</h:panelGroup>
						<h:panelGroup id="rol_2">
							<h:inputText  value="#{rdvCtrl.defaultVue.entiteCourante.tabUsr.libRol}" style="width: 60%"  readonly="true" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>
						</h:panelGroup>
         					
						<h:panelGroup id="adr_1">
							<h:outputText value="Adresse" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>
						</h:panelGroup>	
						<h:panelGroup id="adr_2">
							<h:inputText  value="#{rdvCtrl.defaultVue.entiteCourante.tabUsr.libAdr}" style="width: 60%"  readonly="true" rendered="#{! empty rdvCtrl.defaultVue.entiteCourante.tabUsr.codUsr}"/>
						</h:panelGroup>	
							
         			</h:panelGrid> 
         				         		         		
         		</h:panelGrid>  
         	
				</fieldset>								
			</h:panelGroup>
			
			<h:panelGroup>
				<fieldset>
					<legend> <h:outputText value="Autres informations" styleClass="legend" />  </legend>

        			<h:panelGrid columns="2" width="100%" columnClasses="pngdColMiddle" rowClasses="pngdRow"  >
        							         		
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >

							<h:outputText value="Date de Demande" />
							<h:panelGroup >					
								<rich:calendar value="#{rdvCtrl.defaultVue.entiteCourante.dateDem}" inputStyle="width: 30%"  title="Date de Demande" 
										styleClass="selectDate"  datePattern="dd/MM/yyyy" >
									<a4j:support event="onchanged" ajaxSingle="true" />
								</rich:calendar>
							</h:panelGroup>
							
							<h:outputText value="Date du rendez vous" />
							<h:panelGroup >					
								<rich:calendar value="#{rdvCtrl.defaultVue.entiteCourante.dateRdv}" inputStyle="width: 30%"  title="Date du rendez vous" 
										styleClass="selectDate"  datePattern="dd/MM/yyyy HH:mm" >
									<a4j:support event="onchanged" ajaxSingle="true" />
								</rich:calendar>
							</h:panelGroup>
							
         				</h:panelGrid>  
         				
         				<h:panelGrid columns="2"  width="100%" columnClasses="pngdColLeftDynamic,pngdColRightDynamic"  >
         				
         					<h:outputText value="#{locale.numordre}"/>
							<h:inputText id="inpt_num" value="#{rdvCtrl.defaultVue.entiteCourante.valNumOrdre}"  styleClass="money" 
								 required="false" style="width: 10%" 
								  title="Effectif"
								 converterMessage="#{msg['erreur.conversion.entiere']}"  >
							</h:inputText>
							
							<h:outputText value="Observations"/>
							<h:inputTextarea id="inpt_obs" value="#{rdvCtrl.defaultVue.entiteCourante.libObs}"  style="width: 60%" 
								  title="Observations">
							</h:inputTextarea>
							
         				</h:panelGrid> 
         				         		         		
         			</h:panelGrid>  
         	
				</fieldset>								
			</h:panelGroup>
			
		</ui:define>
													
	</ui:composition>
	
</html>
